<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Livestream Schedule</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .shp-bg { border-left: 5px solid #ee4d2d; } /* Màu Shopee */
        .tts-bg { border-left: 5px solid #000000; } /* Màu TikTok */
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4">

    <div class="max-w-4xl mx-auto">
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">Lịch Livestream OAP</h1>
            
            <select id="sheetSelector" onchange="fetchData()" class="w-full p-3 rounded-lg border-2 border-blue-500 bg-white shadow-sm focus:outline-none">
                <option value="https://script.google.com/macros/s/AKfycbwbh3yEofUucmpwWUcbcccy0nKp3hWjqZoDDmcL187ZKDnYBVrP1DYyXjFo5xGzpn25/exec">Brand: OAP</option>
                <option value="https://script.google.com/macros/s/AKfycbwbh3yEofUucmpwWUcbcccy0nKp3hWjqZoDDmcL187ZKDnYBVrP1DYyXjFo5xGzpn25/exec">Brand: MNY</option>
                <option value="https://script.google.com/macros/s/AKfycbwbh3yEofUucmpwWUcbcccy0nKp3hWjqZoDDmcL187ZKDnYBVrP1DYyXjFo5xGzpn25/exec">Brand: GAR</option>
                <option value="https://script.google.com/macros/s/AKfycbwbh3yEofUucmpwWUcbcccy0nKp3hWjqZoDDmcL187ZKDnYBVrP1DYyXjFo5xGzpn25/exec">Brand: 3CE</option>
            </select>
        </header>

        <div id="loader" class="hidden text-center text-blue-600 font-bold">Đang tải dữ liệu...</div>
        <div id="container" class="grid gap-4"></div>
    </div>

    <script>
        async function fetchData() {
            const url = document.getElementById('sheetSelector').value;
            const container = document.getElementById('container');
            const loader = document.getElementById('loader');

            loader.classList.remove('hidden');
            container.innerHTML = '';

            try {
                const response = await fetch(url);
                const data = await response.json();
                
                data.forEach(item => {
                    const card = document.createElement('div');
                    const platformClass = item.platform === 'SHP' ? 'shp-bg' : 'tts-bg';
                    
                    card.className = `bg-white p-4 rounded-xl shadow-md ${platformClass} hover:shadow-lg transition-shadow`;
                    card.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <span class="text-xs font-bold px-2 py-1 rounded ${item.platform === 'SHP' ? 'bg-orange-100 text-orange-600' : 'bg-gray-200 text-black'}">${item.platform}</span>
                                <span class="ml-2 text-sm text-gray-500 font-medium">${item.date} (${item.day})</span>
                            </div>
                            <div class="text-right text-blue-600 font-bold">${item.start_time} - ${item.end_time}</div>
                        </div>
                        <div class="mt-3">
                            <div class="text-lg font-bold text-gray-800 uppercase">Host: ${item.host}</div>
                            <div class="text-sm text-gray-600">Loại: ${item.type} | PIC: ${item.pic}</div>
                        </div>
                        ${item.duo_host ? `<div class="mt-2 text-xs bg-blue-50 p-2 rounded text-blue-700">Duo: ${item.duo_host}</div>` : ''}
                    `;
                    container.appendChild(card);
                });
            } catch (error) {
                container.innerHTML = '<p class="text-red-500 text-center">Không thể tải dữ liệu. Hãy kiểm tra lại link API.</p>';
            } finally {
                loader.classList.add('hidden');
            }
        }

        // Tải dữ liệu lần đầu
        fetchData();
    </script>
</body>
</html>